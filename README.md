Implement user authentication (cookie-based?) and user RBAC flow using dependency injection. 

Write tests with relevant fixtures. 
